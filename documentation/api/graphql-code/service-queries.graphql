
# open:
# - when time is set
#   - do not filter for active=true
#   - filter for state in time instead
# - filter cidr properly (based on netmask)
# - filter so that port ranges are also found   

# comment:
# - the following contains a bit of redundancy:
#   - svc_typ_id is a reference refering to stm_svc_typ table
#   - svc_color_id is a reference refering to stm_color table

query listNwServices($management_id: [Int!], $time: String, $service_name: [String!], $service_port: [Int!]) {
  management(where: {mgm_id: {_in: $management_id}}) {
    mgm_id
    mgm_name
    services(where: {active: {_eq: true}, svc_name: {_in: $service_name}, svc_port: {_in: $service_port}}, order_by: {svc_name: asc}) {
      svc_id
      svc_name
      svc_uid
      svc_port
      svc_port_end
      svc_source_port
      svc_source_port_end
      svc_typ_id
      stm_svc_typ {
        svc_typ_name
      }
      svc_comment
      svc_color_id
      stm_color {
        color_id
        color_name
      }
      svc_member_names
      svc_member_refs
    }
  }
}
