
query listNwObjects($management_id: [Int!], $time: String, $obj_name: [String!], $obj_ip: [cidr!], $limit:Int, $offset:Int) {
  management(where: {mgm_id: {_in: $management_id}}) {
    mgm_id
    mgm_name
    objects(limit:$limit offset: $offset where: {active: {_eq: true}, obj_name: {_in: $obj_name}, obj_ip: {_in: $obj_ip}}, order_by: {obj_name: asc}) {
      obj_id
      obj_name
      obj_uid
      obj_nat
      obj_ip
      obj_ip_end
      obj_nat_ip
      obj_typ_id
      stm_obj_typ {
        obj_typ_name
      }
      obj_comment
      obj_color_id
      obj_member_names
      obj_member_refs
    }
  }
}

# needs to be exact import id for the specific device, otherwise it might not return desired results
query listHistoricalObjects($import_id: Int!, $management_id:Int) {
  object_aggregate(where: {mgm_id:{_eq:$mgmt},obj_create:{_lte:$import_id},obj_last_seen:{_gte:$import_id}}) {aggregate {count}}
  object(where: {mgm_id:{_eq:$mgmt},obj_create:{_lte:$import_id},obj_last_seen:{_gte:$import_id}}) {
    obj_name
    mgm_id
    obj_create
    obj_last_seen
  }
}
