<VirtualHost *:{{ ui_web_port }}>
	ServerName {{ ui_server_name }}:{{ ui_web_port }}
	ServerAdmin {{ ui_server_admin }}
	DocumentRoot "{{ ui_start_dir }}"

    ProxyRequests On
    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>

	RewriteEngine on
    RewriteCond ${HTTP:Upgrade} websocket [NC]
    RewriteCond ${HTTP:Connection} upgrade [NC]
    RewriteRule .* "wss:/{{ ui_hostname }}:{{ ui_port }}/$1" [P,L]

	ProxyPass "/api"  "http://{{ api_hostname }}:{{ api_port }}/"
	ProxyPassReverse "/api"  "http://{{ api_hostname }}:{{ api_port }}/"

	ProxyPass "/"  "http://{{ ui_hostname }}:{{ ui_port }}/"
	ProxyPassReverse "/"  "http://{{ ui_hostname }}:{{ ui_port }}/"

	ErrorLog /var/log/{{ ui_web_server_name }}/error.log
	TransferLog /var/log/{{ ui_web_server_name }}/access.log
	CustomLog /var/log/{{ ui_web_server_name }}/ssl_request_log "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
	SSLEngine on
	SSLCipherSuite RSA:!EXP:!NULL:+HIGH:+MEDIUM:-LOW 
	SSLCertificateFile /etc/{{ ui_web_server_name }}/ssl/server.crt
	SSLCertificateKeyFile /etc/{{ ui_web_server_name }}/ssl/server.key
</VirtualHost>
