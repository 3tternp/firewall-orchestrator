query ruleFilterKVInTimeSingleValues(
  $managementId: [Int!]
  $deviceId: [Int!]
  $reportTime: timestamp
  $ruleSrcName1: String
  $ruleSrcName2: String
  $limit: Int
  $offset: Int
) {
  management(
    where: { mgm_id: { _in: $managementId } }
    order_by: { mgm_name: asc }
  ) {
    mgm_id
    mgm_name
    devices(
      where: { dev_id: { _in: $deviceId } }
      order_by: { dev_name: asc }
    ) {
      dev_id
      dev_name
    }
    rules(
      limit: $limit
      offset: $offset
      where: {
        _and: {
          import_control: { stop_time: { _lte: $reportTime } }
          importControlByRuleLastSeen: { stop_time: { _gt: $reportTime } }
          rule_disabled: { _eq: false }
          _or: [
            { rule_src: { _ilike: $ruleSrcName1 } }
            { rule_src: { _ilike: $ruleSrcName2 } }
          ]
        }
      }
      order_by: { rule_num_numeric: asc }
    ) {
      rule_uid
      rule_src
      lastSeenImport: importControlByRuleLastSeen {
        stop_time
        control_id
      }
      createImport: import_control {
        stop_time
        control_id
      }
    }
  }
}

# replace rule values with ...ruleOverview
