query showManufacturers {
  stm_dev_typ {
    dev_typ_id
    dev_typ_manufacturer
    dev_typ_version
  }
}

#####################################

query showManagements {
  management {
    mgm_id
    mgm_name
  }
}

query showManagementDetails {
  management {
    dev_typ_id
    hide_in_gui
    do_not_import
    force_initial_import
    importer_hostname
    last_import_md5_complete_config
    last_import_md5_objects
    last_import_md5_rules
    last_import_md5_users
    config_path
    mgm_comment
    mgm_create
    mgm_id
    mgm_name
    mgm_update
    ssh_hostname
    ssh_port
    ssh_private_key
    ssh_public_key
    ssh_user
  }
}

query showDevicesByManagement {
  management {
    mgm_name
    devices {
      dev_name
    }
  }
}

query showDevicesByManagementDetails {
  management {
    mgm_name
    devices {
      dev_name
      stm_dev_typ {
        dev_typ_name
        dev_typ_version
      }
    }
  }
}

#####################################

query showDevices {
  device {
    dev_id
    dev_name
    dev_rulebase
    management {
      mgm_id
      mgm_name
    }
  }
}

query showDevicesWithType {
  device {
    dev_id
    dev_name
    stm_dev_typ {
      dev_typ_name
      dev_typ_version
    }
  }
}

###################################

query showManufacturers {
  stm_dev_typ(order_by: { dev_typ_manufacturer: asc, dev_typ_version: asc }) {
    dev_typ_id
    dev_typ_manufacturer
    dev_typ_version
  }
}

#############################
## mutations
#############################

mutation newManagement(
  $dev_typ_id: Int!
  $mgm_name: String!
  $ssh_private_key: String!
) {
  insert_management(
    objects: {
      config_path: ""
      dev_typ_id: $dev_typ_id
      importer_hostname: ""
      mgm_name: $mgm_name
      ssh_hostname: ""
      ssh_private_key: $ssh_private_key
      ssh_user: ""
    }
  ) {
    returning {
      mgm_id
    }
  }
}
