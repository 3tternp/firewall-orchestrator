
{ "queries": 
    [
        {
            "name": "listRules",
            "query": "query listRules($management_id: [Int!], $device_id: [Int!], $rule_src_name: [String!], $rule_src_ip: [cidr!], $limit: Int, $offset: Int) {
                management(where: {mgm_id: {_in: $management_id}}) {
                    mgm_id
                    mgm_name
                    devices(where: {dev_id: {_in: $device_id}}) {
                        dev_id
                        dev_name
                        rules(limit: $limit, offset: $offset, where: {active: {_eq: true}, rule_src: {_in: $rule_src_name}, rule_disabled: {_eq: false}, rule_froms: {object: {obj_ip: {_in: $rule_src_ip}}}}, order_by: {rule_num_numeric: asc}) {
                            rule_num_numeric
                            rule_disabled
                            rule_src_neg
                            rule_src
                            rule_froms {
                                object {
                                    obj_ip
                                }
                            }
                            rule_dst_neg
                            rule_dst
                            rule_tos {
                                object {
                                    obj_ip
                                }
                            }
                            rule_svc_neg
                            rule_svc
                            rule_services {
                                service {
                                    svc_name
                                    svc_port
                                    stm_svc_typ {
                                    svc_typ_name
                                    }
                                }
                            }
                            rule_action
                            rule_track
                        }
                    }
                }
            }"
        },

        {
            "name": "listRulesDetails"
            "query": "query listRulesDetails($managementId: [Int!], $deviceId: [Int!], $ruleSrcName: [String!], $ruleSrcIp: [cidr!], $limit: Int, $offset: Int) {
                management(where: {mgm_id: {_in: $managementId}}) {
                  mgm_id
                  mgm_name
                  devices(where: {dev_id: {_in: $deviceId}}) {
                    dev_id
                    dev_name
                    rules(limit: $limit, offset: $offset, where: {active: {_eq: true}, rule_src: {_in: $ruleSrcName}, rule_disabled: {_eq: false}, rule_froms: {object: {obj_ip: {_in: $ruleSrcIp}}}}, order_by: {rule_num_numeric: asc}) {
                      ...ruleDetails
                    }
                  }
                }
              }
              
             fragment ruleDetails on rule {
                rule_id
                rule_action
                rule_comment
                rule_track
                rule_disabled
                rule_src_neg
                rule_dst_neg
                rule_svc_neg
                rule_num_numeric
                rule_name
                rule_src
                rule_froms {
                  user_id
                  object {
                    obj_comment
                    obj_ip
                    obj_ip_end
                    obj_member_names
                    obj_member_refs
                    obj_name
                    obj_uid
                    zone_id
                  }
                }
                rule_dst
                rule_tos {
                  object {
                    obj_comment
                    obj_ip
                    obj_ip_end
                    obj_member_names
                    obj_member_refs
                    obj_name
                    obj_uid
                    zone_id
                  }
                }
                rule_svc
                rule_services {
                  service {
                    svc_uid
                    svc_name
                    svc_typ_id
                    ip_proto_id
                    svc_comment
                    svc_member_names
                    svc_member_refs
                    svc_port
                    svc_port_end
                  }
                }
              }"
        },
        {
            "name": "listRuleChanges",
                "query": "query listRuleChanges($startId: Int, $stopId: Int, $devId: Int, $changeType: bpchar) {
                    changelog_rule(where: {_and: [{control_id: {_lt: $stopId}}, {control_id: {_gt: $startId}}, {security_relevant: {_eq: true}}], dev_id: {_eq: $devId}, change_action: {_eq: $changeType}}) {
                    change_request_info
                    change_time
                    changelog_rule_comment
                    new_rule_id
                    old_rule_id
                    unique_name
                    dev_id
                    change_action
                    rule {
                        rule_id
                        rule_src
                        rule_dst
                        rule_svc
                        rule_action
                    }
                    ruleByOldRuleId {
                        rule_id
                        rule_src
                        rule_dst
                        rule_svc
                        rule_action
                    }
                }
            }"
        },
        {
            "name": "listRuleChangesFull",
                "query": "query listRuleChangesFull($startId: Int, $stopId: Int, $devId: Int, $changeType: bpchar) {
                  changelog_rule(where: {_and: [{control_id: {_lt: $stopId}}, {control_id: {_gt: $startId}}, {security_relevant: {_eq: true}}], dev_id: {_eq: $devId}, change_action: {_eq: $changeType}}) {
                    dev_id
                    change_action
                    import_run_details: import_control {
                      import_id: control_id
                      mgm_id
                      is_initial_import
                      import_time: stop_time
                    }
                    rule {
                      ...ruleDetails
                    }
                    ruleByOldRuleId {
                      ...ruleDetails
                    }
                  }
                }
                
                fragment ruleDetails on rule {
                  rule_id
                  rule_num_numeric
                  rule_action
                  rule_comment
                  rule_track
                  rule_disabled
                  rule_src_neg
                  rule_dst_neg
                  rule_svc_neg
                  rule_name
                  rule_src
                  rule_froms {
                    user_id
                    object {
                      obj_comment
                      obj_ip
                      obj_ip_end
                      obj_member_names
                      obj_member_refs
                      obj_name
                      obj_uid
                      zone_id
                    }
                  }
                  rule_dst
                  rule_tos {
                    object {
                      obj_comment
                      obj_ip
                      obj_ip_end
                      obj_member_names
                      obj_member_refs
                      obj_name
                      obj_uid
                      zone_id
                    }
                  }
                  rule_svc
                  rule_services {
                    service {
                      svc_uid
                      svc_name
                      svc_typ_id
                      ip_proto_id
                      svc_comment
                      svc_member_names
                      svc_member_refs
                      svc_port
                      svc_port_end
                    }
                  }
                }"
        }
    ]
}
